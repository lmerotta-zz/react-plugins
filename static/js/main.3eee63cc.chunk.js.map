{"version":3,"sources":["../../src/utils/store.ts","../../src/components/PluginStoreProvider.tsx","../../src/components/Plugins.tsx","components/Sidebar.tsx","components/Page.tsx","modules/billing/components/BillingWidget.tsx","modules/billing/components/BillingSection.tsx","modules/admin/components/AdminWidget.tsx","modules/admin/components/AdminSection.tsx","App.tsx","index.tsx"],"names":["constructor","sections","listeners","subscribe","this","current","registerPlugin","priority","pluginStore","section","component","name","listener","removePlugin","getPluginsForSection","a","b","ProviderContext","React","PluginStoreProvider","children","contextValues","useMemo","store","PluginStore","value","Plugins","useContext","useReducer","s","useEffect","unsub","forceRender","key","index","Component","Sidebar","style","width","height","padding","backgroundColor","display","alignItems","flex","justifyContent","Page","BillingWidget","cursor","onClick","alert","BillingSection","useState","isActive","setActive","type","checked","onChange","e","target","AdminWidget","badgeCount","position","color","fontSize","fontWeight","borderRadius","top","left","AdminSection","count","setCount","step","min","parseInt","App","minHeight","flexDirection","ReactDOM","render","fallback","document","getElementById"],"mappings":"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","file":"static/js/main.3eee63cc.chunk.js","sourcesContent":["import { ComponentType } from 'react';\nimport { PluginStoreType } from '../types';\n\nexport class PluginStore {\n  private sections: PluginStoreType = {};\n  private listeners: Array<(sections: PluginStoreType) => void> = [];\n\n  subscribe(listener: (sections: PluginStoreType) => void): () => void {\n    this.listeners.push(listener);\n\n    // return unsubscribe callback\n    return (): void => {\n      this.listeners = this.listeners.filter((current) => current !== listener);\n    };\n  }\n\n  registerPlugin(\n    section: string,\n    component: ComponentType | JSX.Element,\n    name: string,\n    priority = 0\n  ): void {\n    const pluginStore = this.sections[section] || [];\n\n    // if we find a component with the given name, replace it\n    if (pluginStore.findIndex((current) => current.name === name) !== -1) {\n      this.sections[section] = pluginStore.map((current) =>\n        current.name === name\n          ? {\n              component,\n              priority,\n              name\n            }\n          : current\n      );\n    } else {\n      this.sections[section] = [...pluginStore, { component, priority, name }];\n    }\n\n    this.listeners.forEach((listener) => listener(this.sections));\n  }\n\n  removePlugin(section: string, name: string): void {\n    const pluginStore = this.sections[section] || [];\n\n    this.sections[section] = pluginStore.filter(\n      (current) => current.name !== name\n    );\n\n    this.listeners.forEach((listener) => listener(this.sections));\n  }\n\n  getPluginsForSection(section: string): Array<ComponentType | JSX.Element> {\n    const pluginStore = this.sections[section];\n\n    if (!pluginStore || pluginStore.length < 1) {\n      return [];\n    }\n\n    return pluginStore\n      .sort((a, b) => a.priority - b.priority)\n      .map((a) => a.component);\n  }\n}\n\nexport default new PluginStore();\n","import React, { useMemo } from 'react';\nimport PluginStore from '../utils/store';\n\ntype ProviderContextType = {\n  store: typeof PluginStore;\n};\n\nexport const ProviderContext = React.createContext<ProviderContextType>(\n  {} as ProviderContextType\n);\n\nconst PluginStoreProvider: React.FC = ({ children }) => {\n  const contextValues = useMemo(\n    () => ({\n      store: PluginStore\n    }),\n    [PluginStore]\n  );\n\n  return (\n    <ProviderContext.Provider value={contextValues}>\n      {children}\n    </ProviderContext.Provider>\n  );\n};\n\nexport default PluginStoreProvider;\n","import React, { useContext, useEffect, useReducer } from 'react';\nimport { ProviderContext } from './PluginStoreProvider';\n\ntype PluginsProps = {\n  section: string;\n};\n\nconst Plugins = ({ section }: PluginsProps) => {\n  const { store } = useContext(ProviderContext);\n  const [, forceRender] = useReducer((s) => s + 1, 0);\n\n  useEffect(() => {\n    const unsub = store.subscribe(() => {\n      forceRender();\n    });\n\n    return (): void => {\n      unsub();\n    };\n  });\n\n  return (\n    <React.Fragment>\n      {store.getPluginsForSection(section).map((component, index) => {\n        if (React.isValidElement(component)) {\n          return (\n            <React.Fragment key={`${section}-${index}-element`}>\n              {component}\n            </React.Fragment>\n          );\n        } else {\n          const Component = component as React.ComponentType;\n          return <Component key={`${section}-${index}-element`} />;\n        }\n      })}\n    </React.Fragment>\n  );\n};\n\nexport default Plugins;\n","import React from 'react';\nimport { Plugins } from 'react-plugins';\n\nconst Sidebar = () => (\n  <div\n    style={{\n      width: 'calc(100% - 30px)',\n      height: '90px',\n      padding: '10px 15px',\n      backgroundColor: '#95a5a6',\n      display: 'flex',\n      alignItems: 'center'\n    }}\n  >\n    <h1 style={{ flex: 10 }}>Logo</h1>\n    <div style={{ display: 'flex', justifyContent: 'space-around', flex: 1 }}>\n      <Plugins section='sidebar' />\n    </div>\n  </div>\n);\n\nexport default Sidebar;\n","import React from 'react';\n\nconst Page: React.FC = ({ children }) => {\n  return <div style={{ flex: 1, padding: '0 15px' }}>{children}</div>;\n};\n\nexport default Page;\n","import React from 'react';\n\nconst BillingWidget = () => (\n  <div style={{ cursor: 'pointer' }} onClick={() => alert('Billing clicked')}>\n    <b>Billing</b>\n  </div>\n);\n\nexport default BillingWidget;\n","import React, { useEffect, useState } from 'react';\nimport { PluginStore } from 'react-plugins';\nimport BillingWidget from './BillingWidget';\n\nconst BillingSection = () => {\n  const [isActive, setActive] = useState(true);\n\n  useEffect(() => {\n    if (isActive) {\n      // will appear first\n      PluginStore.registerPlugin('sidebar', BillingWidget, 'billing-widget', 0);\n    } else {\n      PluginStore.removePlugin('sidebar', 'billing-widget');\n    }\n  });\n\n  return (\n    <div style={{ width: '100%' }}>\n      <h2>Billing section</h2>\n      <label>\n        <input\n          type='checkbox'\n          checked={isActive}\n          onChange={(e) => setActive(e.target.checked)}\n        />{' '}\n        Toggle the billing module on/off\n      </label>\n    </div>\n  );\n};\n\nexport default BillingSection;\n","import React from 'react';\n\ntype AdminWidgetProps = {\n  badgeCount: number;\n};\n\nconst AdminWidget = ({ badgeCount }: AdminWidgetProps) => (\n  <div style={{ position: 'relative' }}>\n    <b>Admin</b>\n    <span\n      style={{\n        backgroundColor: 'red',\n        color: 'white',\n        width: '27px',\n        height: '25px',\n        fontSize: '11px',\n        fontWeight: 'bold',\n        display: 'inline-flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        borderRadius: '50%',\n        position: 'absolute',\n        top: '-90%',\n        left: '90%'\n      }}\n    >\n      {badgeCount > 99 ? '99+' : badgeCount}\n    </span>\n  </div>\n);\n\nexport default AdminWidget;\n","import React, { useEffect, useState } from 'react';\nimport { PluginStore } from 'react-plugins';\nimport AdminWidget from './AdminWidget';\n\nconst AdminSection = () => {\n  const [count, setCount] = useState(0);\n\n  useEffect(() => {\n    PluginStore.registerPlugin(\n      'sidebar',\n      <AdminWidget badgeCount={count} />,\n      'admin-widget',\n      -100\n    );\n  });\n\n  return (\n    <div style={{ width: '100%' }}>\n      <h2>Admin section</h2>\n      <p>Set number of badges in the widget</p>\n      <input\n        type='number'\n        step='1'\n        min='0'\n        value={count}\n        onChange={(e) => setCount(parseInt(e.target.value, 10) || 0)}\n      />\n    </div>\n  );\n};\n\nexport default AdminSection;\n","import React from 'react';\nimport Sidebar from './components/Sidebar';\nimport ModulesPage from './components/Page';\nimport BillingSection from './modules/billing/components/BillingSection';\nimport AdminSection from './modules/admin/components/AdminSection';\n\nconst App = () => (\n  <div\n    style={{\n      width: '100vw',\n      minHeight: '100vh',\n      display: 'flex',\n      flexDirection: 'column'\n    }}\n  >\n    <Sidebar />\n    <ModulesPage>\n      <BillingSection />\n      <AdminSection />\n    </ModulesPage>\n  </div>\n);\n\nexport default App;\n","import './index.css';\n\nimport React, { Suspense } from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport { PluginStoreProvider } from 'react-plugins';\n\nReactDOM.render(\n  <Suspense fallback='Loading...'>\n    <PluginStoreProvider>\n      <App />\n    </PluginStoreProvider>\n  </Suspense>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}